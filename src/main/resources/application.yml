spring:
  application:
    name: java-api

  # H2 Console (for development)
  h2:
    console:
      enabled: ${H2_CONSOLE_ENABLED:true}
      path: /h2-console

  # Redis Configuration (optional caching)
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      timeout: ${REDIS_TIMEOUT:2000}
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0

  # Cache Configuration
  cache:
    type: ${CACHE_TYPE:simple}
    cache-names:
      - users
      - products
      - orders

# Server Configuration
server:
  port: ${SERVER_PORT:8080}
  servlet:
    context-path: /api/v1
  tomcat:
    threads:
      max: ${SERVER_MAX_THREADS:200}
      min-spare: ${SERVER_MIN_THREADS:10}

# Application Configuration
app:
  # Dynamic Datasources - Add as many as needed, reference by name
  # Example: dataSourceRegistry.getNamedParameterJdbcTemplate("InventoryDB")
  datasources:
    # Default development database (H2 in-memory)
    DefaultDB:
      url: ${DEFAULT_DB_URL:jdbc:h2:mem:defaultdb;DB_CLOSE_DELAY=-1}
      username: ${DEFAULT_DB_USERNAME:sa}
      password: ${DEFAULT_DB_PASSWORD:}
      driver-class-name: ${DEFAULT_DB_DRIVER:org.h2.Driver}
      primary: true
      hikari:
        pool-name: DefaultDBPool
        maximum-pool-size: 10
        minimum-idle: 5
        idle-timeout: 300000
        connection-timeout: 20000
        max-lifetime: 1200000
        leak-detection-threshold: 60000

    # Example: Add more databases as needed
    # InventoryDB:
    #   url: jdbc:postgresql://localhost:5432/inventory
    #   username: postgres
    #   password: secret
    #   driver-class-name: org.postgresql.Driver
    #   hikari:
    #     pool-name: InventoryDBPool
    #     maximum-pool-size: 15

    # OrdersDB:
    #   url: jdbc:mysql://localhost:3306/orders
    #   username: root
    #   password: secret
    #   driver-class-name: com.mysql.cj.jdbc.Driver

  sql:
    base-path: classpath:sql/
  async:
    core-pool-size: ${ASYNC_CORE_POOL_SIZE:5}
    max-pool-size: ${ASYNC_MAX_POOL_SIZE:10}
    queue-capacity: ${ASYNC_QUEUE_CAPACITY:25}
  pagination:
    default-page-size: ${DEFAULT_PAGE_SIZE:20}
    max-page-size: ${MAX_PAGE_SIZE:100}
  external-api:
    timeout: ${EXTERNAL_API_TIMEOUT:5000}
    retry-attempts: ${EXTERNAL_API_RETRY:3}

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: when_authorized
  health:
    redis:
      enabled: ${REDIS_HEALTH_ENABLED:false}

# OpenAPI Documentation
springdoc:
  api-docs:
    path: /api-docs
  swagger-ui:
    path: /swagger-ui.html
    enabled: true

# Logging Configuration
logging:
  level:
    root: INFO
    com.api: DEBUG
    org.springframework.jdbc: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
